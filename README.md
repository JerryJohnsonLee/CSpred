# UCB-ChemShift

UCB-ChemShift is a program for predicting chemical shifts for backbone atoms and β-carbon of a protein in solution. The program implements two mechanisms:  a transfer prediction module that employs both sequence alignment and structure alignment to select references for shift replication; and an ensemble decision tree based machine learning module which takes features extracted from a PDB file and makes trustful chemical shift predictions. When combined together, this new predictor achieves state-of-the-art accuracy for predicting chemical shifts in a "real-world" dataset, with root-mean-square errors of  0.38, 0.22, 1.31, 0.97, 1.29 and 2.16 ppm between prediction and experimental values for H, Hα, C, Cα, Cβ and N.

## Software package requirements
### Python and python packages
* Python (>=3.5)
* Numpy 
* Pandas
* scikit learn (https://scikit-learn.org/stable/)
* Biopython (https://biopython.org/)
* Joblib (https://joblib.readthedocs.io/en/latest/)

###  External programs needed
* blast (2.9.0, https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&PAGE_TYPE=BlastDocs&DOC_TYPE=Download)
* mTM-align (20180725, http://yanglab.nankai.edu.cn/mTM-align/)
* DSSP (2.04, https://swift.cmbi.umcn.nl/gv/dssp/)

## Usage
The [`CSpred.py`](https://github.com/JerryJohnsonLee/CSpred/blob/master/CSpred.py) file is the entrance to UCB-ChemShift chemical shift predictor. <br><br>
<pre>
CSpred.py [-h] [--batch] [--output OUTPUT] [--tp_only] [--ml_only]
          [--pH PH] [--test]
          input

positional arguments:
  input                 The query PDB file or list of PDB files for which the
                        shifts are calculated

optional arguments:
  -h, --help            show this help message and exit
  --batch, -b           If toggled, input accepts a text file specifying all
                        the PDB files need to be calculated (Each line is a
                        PDB file name. If pH values are specified, followed
                        with a space)
  --output OUTPUT, -o OUTPUT
                        Filename of generated output file. A file [shifts.csv]
                        is generated by default
  --tp_only, -tp        Only use the transfer prediction module. Equivalent to
                        executing the SHIFTY++ program directly with default
                        settings
  --ml_only, -ml        Only use the machine learning module. No alignment
                        results will be utilized or calculated
  --pH PH, -pH PH, -ph PH
                        pH value to be considered. Default is 5
  --test, -t            If toggled, using test mode for TP prediction
</pre>
         
